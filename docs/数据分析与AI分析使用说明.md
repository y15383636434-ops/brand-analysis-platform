# 🤖 数据分析与AI分析使用说明

## 📋 功能概述

新的数据分析功能可以将MediaCrawler爬取的JSON数据整理出来，并使用AI进行深度分析，包括：

1. **数据整理** - 自动提取文本、标题、评论等结构化数据
2. **情感分析** - 分析文本的情感倾向（正面/负面/中性）
3. **关键词提取** - 提取高频关键词和权重
4. **文本统计** - 统计文本数量、长度等信息
5. **AI深度分析** - 使用大语言模型进行深度洞察分析

---

## 🚀 快速开始

### 1. 启动Web服务

```bash
# 方式1: 使用一键启动脚本
python 一键启动.py

# 方式2: 直接启动FastAPI
python -m uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

### 2. 访问数据分析界面

打开浏览器访问：
- **数据分析界面**: http://localhost:8000/api/v1/data-analysis
- **分析结果页面**: http://localhost:8000/api/v1/data-analysis/result
- **API文档**: http://localhost:8000/docs

---

## 📖 使用步骤

### 步骤1: 打开数据分析界面

访问 `http://localhost:8000/api/v1/data-analysis`

### 步骤2: 选择平台和数据文件

1. **选择平台**
   - 从下拉菜单中选择要分析的平台（如：小红书）

2. **选择数据文件**
   - 系统会自动加载该平台的数据文件列表
   - 勾选要分析的文件（可多选）
   - 文件信息包括文件名、大小、修改时间

### 步骤3: 配置分析选项

1. **包含评论数据**
   - ✅ 勾选：分析时会包含评论数据
   - ❌ 不勾选：只分析内容数据

2. **分析类型**
   - **综合分析**: 全面的品牌分析（推荐）
   - **品牌形象分析**: 专注于品牌形象定位
   - **用户反馈分析**: 专注于用户反馈和满意度
   - **趋势分析**: 专注于趋势预测

### 步骤4: 开始分析

点击"开始分析"按钮，系统会：
1. 整理选中的数据文件
2. 提取文本、标题、评论等信息
3. 执行情感分析
4. 提取关键词
5. 进行文本统计
6. 使用AI进行深度分析

**注意**: 分析过程可能需要几分钟时间，请耐心等待。

### 步骤5: 查看分析结果

分析完成后，可以：
1. 在当前页面查看简要结果
2. 点击"查看详细分析结果"查看完整报告
3. 在分析结果页面查看历史分析记录

---

## 📊 分析结果说明

### 1. 数据统计

- **总数据量**: 处理的数据条数
- **文本数量**: 提取的文本数量
- **评论数量**: 提取的评论数量
- **文件数量**: 分析的文件数量

### 2. 情感分析

- **正面数量**: 正面情感文本数量及占比
- **负面数量**: 负面情感文本数量及占比
- **中性数量**: 中性情感文本数量及占比
- **平均情感分数**: 0-1之间的分数，越接近1越正面

### 3. 关键词分析

- 显示提取的关键词及其权重（TF-IDF）
- 权重越高，说明该关键词越重要

### 4. AI深度分析

根据选择的分析类型，AI会提供：
- **综合分析**: 品牌形象、用户反馈、优势、问题、趋势预测
- **品牌形象分析**: 品牌定位、认知度、联想、差异化优势
- **用户反馈分析**: 满意度、主要反馈、痛点、改进建议
- **趋势分析**: 热度趋势、话题趋势、关注度变化、未来预测

---

## 🔧 技术实现

### 数据整理流程

1. **加载JSON文件**
   - 读取MediaCrawler生成的JSON文件
   - 支持多种数据格式（列表、字典等）

2. **提取文本信息**
   - 根据平台类型提取标题、内容、评论
   - 支持小红书、抖音、微博、知乎等平台

3. **数据清洗**
   - 去除多余空白字符
   - 移除特殊字符
   - 文本去重

### AI分析流程

1. **情感分析**
   - 使用SnowNLP进行中文情感分析
   - 批量分析所有文本

2. **关键词提取**
   - 使用jieba的TF-IDF算法
   - 提取前20个关键词及权重

3. **文本统计**
   - 统计文本数量、长度
   - 词频统计

4. **LLM深度分析**
   - 支持OpenAI、Claude、本地LLM
   - 根据数据摘要生成深度洞察

---

## 📁 数据存储

### 分析结果存储

分析结果会保存到MongoDB的`data_analysis_results`集合中，包括：
- 平台信息
- 分析类型
- 完整分析结果
- 创建时间

### 数据格式

```json
{
  "platform": "xhs",
  "analysis_type": "comprehensive",
  "result": {
    "platform": "xhs",
    "platform_name": "小红书",
    "processed_data": {
      "total_items": 100,
      "total_texts": 100,
      "total_comments": 500,
      "file_count": 1
    },
    "sentiment_analysis": {
      "total": 600,
      "positive_count": 300,
      "negative_count": 100,
      "neutral_count": 200,
      "avg_score": 0.65,
      "distribution": {
        "positive": 50.0,
        "negative": 16.67,
        "neutral": 33.33
      }
    },
    "keywords": [
      {
        "keyword": "关键词1",
        "weight": 0.123
      }
    ],
    "text_statistics": {
      "total_count": 600,
      "total_length": 50000,
      "avg_length": 83.33,
      "word_frequency": []
    },
    "llm_insights": {
      "analysis_type": "comprehensive",
      "insights": "AI生成的深度分析...",
      "model": "OpenAI-gpt-4"
    }
  },
  "created_at": "2025-12-31T12:00:00"
}
```

---

## ⚙️ API端点

### 数据分析

- `GET /api/v1/data-analysis` - 数据分析界面
- `GET /api/v1/data-analysis/files` - 获取文件列表
- `POST /api/v1/data-analysis/process` - 处理数据并分析

### 分析结果

- `GET /api/v1/data-analysis/result` - 分析结果页面
- `GET /api/v1/data-analysis/result/list` - 获取分析结果列表

### API文档

访问 `http://localhost:8000/docs` 查看完整的API文档。

---

## 💡 使用提示

1. **文件选择**
   - 可以选择多个文件进行分析
   - 建议选择同一天或同一主题的文件

2. **分析类型**
   - 首次使用建议选择"综合分析"
   - 根据需求选择特定的分析类型

3. **评论数据**
   - 包含评论数据可以获得更全面的分析
   - 但会增加分析时间

4. **AI模型配置**
   - 需要在`.env`文件中配置AI API密钥
   - 支持OpenAI、Claude、本地LLM

5. **分析时间**
   - 数据量大时，分析可能需要几分钟
   - 请耐心等待，不要重复提交

---

## 🔍 常见问题

### Q1: 分析失败怎么办？

A: 检查以下几点：
- 确认文件是否存在且格式正确
- 检查是否有可分析的文本数据
- 查看终端日志了解详细错误信息

### Q2: AI分析没有结果？

A: 确认：
- AI API密钥是否配置正确
- 网络连接是否正常
- API配额是否充足

### Q3: 如何查看历史分析结果？

A: 
- 访问分析结果页面
- 系统会显示最近50条分析记录
- 可以按平台筛选

### Q4: 分析结果可以导出吗？

A: 
- 目前分析结果保存在MongoDB中
- 可以通过API获取JSON格式的结果
- 未来会支持PDF、Excel等格式导出

---

## 📝 示例

### 示例1: 分析小红书数据

1. 选择平台：小红书
2. 选择文件：`search_contents_2025-12-31.json`
3. 包含评论：是
4. 分析类型：综合分析

### 示例2: 分析抖音用户反馈

1. 选择平台：抖音
2. 选择文件：`search_comments_2025-12-31.json`
3. 包含评论：是
4. 分析类型：用户反馈分析

---

## ✅ 功能清单

- [x] 数据文件选择
- [x] 数据整理和提取
- [x] 情感分析
- [x] 关键词提取
- [x] 文本统计
- [x] AI深度分析
- [x] 分析结果保存
- [x] 分析结果查看
- [x] 多平台支持
- [x] 多文件分析

---

**现在你可以轻松整理爬取的数据并使用AI进行深度分析！** 🎉






