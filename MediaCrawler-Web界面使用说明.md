# 🌐 MediaCrawler Web界面使用说明

## 📋 功能概述

新的Web界面提供了完整的爬虫控制功能，包括：

1. **平台选择** - 支持小红书、抖音、微博、知乎、B站、快手、百度贴吧
2. **爬取类型选择** - 可选择全部、视频、图文
3. **评论选项** - 可选择是否爬取一级评论和二级评论
4. **关键词输入** - 支持多个关键词（逗号分隔）
5. **JSON数据查看** - 实时查看爬取的JSON数据

---

## 🚀 快速开始

### 1. 启动Web服务

```bash
# 方式1: 使用一键启动脚本
python 一键启动.py

# 方式2: 直接启动FastAPI
python -m uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

### 2. 访问Web界面

打开浏览器访问：
- **爬虫控制台**: http://localhost:8000/api/v1/mediacrawler
- **数据查看器**: http://localhost:8000/api/v1/mediacrawler/data?platform=xhs&data_type=contents
- **API文档**: http://localhost:8000/docs

---

## 📖 使用步骤

### 步骤1: 打开爬虫控制台

访问 `http://localhost:8000/api/v1/mediacrawler`

### 步骤2: 配置爬取参数

1. **选择平台**
   - 点击选择要爬取的平台（如：小红书）

2. **输入关键词**
   - 输入搜索关键词，多个关键词用逗号分隔
   - 例如：`华为,小米`

3. **设置最大数量**
   - 设置最大爬取数量（默认10）
   - 范围：1-1000

4. **选择笔记类型**
   - **全部**: 爬取视频和图文笔记
   - **视频**: 只爬取视频
   - **图文**: 只爬取图文笔记

5. **评论选项**
   - ✅ **爬取一级评论**: 爬取笔记下的直接评论
   - ✅ **爬取二级评论**: 爬取评论下的回复（需要先开启一级评论）

### 步骤3: 开始爬取

点击"开始爬取"按钮，系统会：
1. 启动后台爬取任务
2. 显示任务启动成功信息
3. 提供查看数据链接

### 步骤4: 查看数据

1. 点击"查看数据"链接，或访问数据查看器
2. 选择数据类型（内容数据/评论数据）
3. 选择要查看的文件
4. 浏览JSON数据（支持分页）

---

## 🎯 功能详解

### 平台支持

| 平台代码 | 平台名称 | 状态 |
|---------|---------|------|
| xhs | 小红书 | ✅ 支持 |
| douyin | 抖音 | ✅ 支持 |
| weibo | 微博 | ✅ 支持 |
| zhihu | 知乎 | ✅ 支持 |
| bilibili | B站 | ✅ 支持 |
| kuaishou | 快手 | ✅ 支持 |
| tieba | 百度贴吧 | ✅ 支持 |

### 笔记类型

- **全部 (all)**: 爬取所有类型的笔记（视频+图文）
- **视频 (video)**: 只爬取视频内容
- **图文 (image)**: 只爬取图文笔记

**注意**: 部分平台可能不支持笔记类型选择，会使用默认值。

### 评论选项

- **一级评论**: 笔记下的直接评论
- **二级评论**: 评论下的回复（需要先开启一级评论）

---

## 📁 数据存储

### 存储位置

```
MediaCrawler/data/{platform}/json/
├── search_contents_YYYY-MM-DD.json  # 内容数据
└── search_comments_YYYY-MM-DD.json   # 评论数据
```

### JSON格式

- **内容数据**: JSON数组，每个元素是一条内容
- **评论数据**: JSON数组，每个元素是一条评论
- **自动追加**: 同一天的数据会追加到同一文件

---

## 🔍 查看数据

### 数据查看器功能

1. **文件列表**
   - 显示所有可用的JSON文件
   - 显示文件大小和修改时间
   - 点击文件即可查看内容

2. **数据浏览**
   - 分页显示数据（每页20条）
   - 显示总记录数、当前页码、总页数
   - 支持上一页/下一页导航

3. **数据展示**
   - JSON格式美化显示
   - 可滚动查看完整内容
   - 每条记录独立显示

### 访问数据查看器

```
http://localhost:8000/api/v1/mediacrawler/data?platform=xhs&data_type=contents
```

参数说明：
- `platform`: 平台代码（xhs, douyin, weibo等）
- `data_type`: 数据类型（contents=内容, comments=评论）

---

## ⚙️ API端点

### 爬虫控制

- `GET /api/v1/mediacrawler` - 爬虫控制台页面
- `POST /api/v1/mediacrawler/start` - 启动爬取任务

### 数据查看

- `GET /api/v1/mediacrawler/data` - 数据查看器页面
- `GET /api/v1/mediacrawler/data/list` - 获取JSON文件列表
- `GET /api/v1/mediacrawler/data/file` - 获取JSON文件内容（分页）

### API文档

访问 `http://localhost:8000/docs` 查看完整的API文档。

---

## 💡 使用提示

1. **首次使用**
   - 首次使用需要扫码登录（会自动保存登录状态）
   - 下次使用时无需再次登录

2. **爬取数量**
   - 建议从小数量开始测试（如10条）
   - 确认无误后再增加数量

3. **数据查看**
   - 爬取完成后，数据会自动保存
   - 可在数据查看器中实时查看

4. **任务执行**
   - 任务在后台执行，不会阻塞Web界面
   - 查看终端窗口了解爬取进度

5. **错误处理**
   - 如果爬取失败，会显示错误信息
   - 检查关键词是否正确
   - 确认平台是否支持

---

## 🔧 常见问题

### Q1: 任务启动后没有数据？

A: 检查以下几点：
- 确认任务是否成功启动（查看终端窗口）
- 等待足够时间（爬取需要时间）
- 检查数据目录是否存在文件

### Q2: 无法查看数据？

A: 确认：
- 数据文件是否存在
- 文件路径是否正确
- 文件格式是否为有效JSON

### Q3: 登录失败？

A: 
- 首次使用需要扫码登录
- 确保网络连接正常
- 检查MediaCrawler配置

### Q4: 爬取速度慢？

A: 
- 这是正常现象，爬取需要时间
- 可以查看终端窗口了解进度
- 减少爬取数量可以加快速度

---

## 📝 示例

### 示例1: 爬取小红书视频

1. 选择平台：小红书
2. 关键词：`手机评测`
3. 最大数量：20
4. 笔记类型：视频
5. 评论：开启一级评论

### 示例2: 爬取微博图文

1. 选择平台：微博
2. 关键词：`科技新闻,AI`
3. 最大数量：15
4. 笔记类型：图文
5. 评论：开启一级和二级评论

---

## ✅ 功能清单

- [x] 平台选择
- [x] 关键词输入
- [x] 最大数量设置
- [x] 笔记类型选择
- [x] 评论选项
- [x] 任务启动
- [x] JSON数据查看
- [x] 文件列表显示
- [x] 分页浏览
- [x] 数据统计

---

**现在你可以通过Web界面轻松控制爬虫，查看数据！** 🎉






