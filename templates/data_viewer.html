<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ•°æ®æŸ¥çœ‹å™¨ - å“ç‰ŒID: {{ brand_id }}</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            padding: 40px;
        }
        
        h1 {
            color: #333;
            margin-bottom: 10px;
            font-size: 28px;
        }
        
        .subtitle {
            color: #666;
            margin-bottom: 30px;
            font-size: 14px;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }
        
        .stat-card h3 {
            font-size: 14px;
            opacity: 0.9;
            margin-bottom: 10px;
        }
        
        .stat-card .value {
            font-size: 32px;
            font-weight: bold;
        }
        
        .controls {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
            flex-wrap: wrap;
            align-items: center;
        }
        
        select, button {
            padding: 10px 20px;
            border: 2px solid #667eea;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        select {
            background: white;
            color: #333;
        }
        
        select:focus {
            outline: none;
            border-color: #764ba2;
        }
        
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            font-weight: 500;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        
        .data-list {
            margin-top: 20px;
        }
        
        .data-item {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 15px;
            transition: all 0.3s;
        }
        
        .data-item:hover {
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }
        
        .data-item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e9ecef;
        }
        
        .platform-badge {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            text-transform: uppercase;
        }
        
        .platform-xhs { background: #ff2442; color: white; }
        .platform-douyin { background: #000; color: white; }
        .platform-weibo { background: #e6162d; color: white; }
        .platform-zhihu { background: #0084ff; color: white; }
        .platform-bilibili { background: #fb7299; color: white; }
        .platform-kuaishou { background: #ff6600; color: white; }
        
        .data-content {
            color: #333;
            line-height: 1.6;
        }
        
        .data-main-info {
             display: flex;
             gap: 20px;
             align-items: flex-start;
        }

        .data-preview {
             flex: 0 0 200px;
             max-width: 200px;
        }
        
        .data-preview img, .data-preview video {
             width: 100%;
             max-height: 300px;
             border-radius: 8px;
             border: 1px solid #ddd;
             object-fit: contain;
             background: #000;
        }

        .data-details {
             flex: 1;
        }

        .data-content pre {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            font-size: 12px;
            max-height: 200px; /* å‡å°é»˜è®¤é«˜åº¦ */
            overflow-y: auto;
            margin-top: 10px;
        }
        
        .pagination {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 30px;
            align-items: center;
        }
        
        .pagination button {
            padding: 8px 15px;
            font-size: 14px;
        }
        
        .pagination .page-info {
            color: #666;
            font-size: 14px;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }
        
        .error {
            background: #fee;
            color: #c33;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .empty {
            text-align: center;
            padding: 60px;
            color: #999;
        }
        
        .empty-icon {
            font-size: 48px;
            margin-bottom: 10px;
        }
        
        .link-btn {
            display: inline-block;
            margin-top: 5px;
            margin-right: 15px;
            color: #667eea;
            text-decoration: none;
            font-size: 14px;
            font-weight: 500;
        }
        
        .link-btn:hover {
            text-decoration: underline;
        }

        .expand-btn {
            background: none;
            border: none;
            color: #666;
            cursor: pointer;
            padding: 0;
            font-size: 12px;
            text-decoration: underline;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“Š æ•°æ®æŸ¥çœ‹å™¨</h1>
        <div class="subtitle">å“ç‰ŒID: {{ brand_id }} | å“ç‰Œåç§°: <span id="brand-name">åŠ è½½ä¸­...</span></div>
        
        <!-- ç»Ÿè®¡å¡ç‰‡ -->
        <div class="stats" id="stats">
            <div class="stat-card">
                <h3>æ€»æ•°æ®é‡</h3>
                <div class="value" id="total-count">-</div>
            </div>
            <div class="stat-card" id="platform-stats">
                <h3>å¹³å°åˆ†å¸ƒ</h3>
                <div class="value" style="font-size: 16px;">åŠ è½½ä¸­...</div>
            </div>
        </div>
        
        <!-- æ§åˆ¶æ  -->
        <div class="controls">
            <select id="platform-filter">
                <option value="">æ‰€æœ‰å¹³å°</option>
                <option value="xhs">å°çº¢ä¹¦</option>
                <option value="douyin">æŠ–éŸ³</option>
                <option value="weibo">å¾®åš</option>
                <option value="zhihu">çŸ¥ä¹</option>
                <option value="bilibili">Bç«™</option>
                <option value="kuaishou">å¿«æ‰‹</option>
            </select>
            <button onclick="loadData()">åˆ·æ–°æ•°æ®</button>
            <button onclick="loadStats()">åˆ·æ–°ç»Ÿè®¡</button>
            <button onclick="deleteSelected()" id="batch-delete-btn" style="background: #f44336; display: none;">æ‰¹é‡åˆ é™¤</button>
        </div>
        
        <div style="margin-bottom: 15px; display: flex; align-items: center; gap: 10px; padding: 0 5px;">
            <input type="checkbox" id="select-all" onchange="toggleSelectAll()" style="width: 18px; height: 18px; cursor: pointer;">
            <label for="select-all" style="cursor: pointer; color: #333; font-weight: 500;">å…¨é€‰æœ¬é¡µ</label>
            <span id="selected-count" style="color: #666; font-size: 14px; font-weight: 500;"></span>
        </div>
        
        <!-- é”™è¯¯æç¤º -->
        <div id="error" class="error" style="display: none;"></div>
        
        <!-- æ•°æ®åˆ—è¡¨ -->
        <div class="data-list" id="data-list">
            <div class="loading">åŠ è½½ä¸­...</div>
        </div>
        
        <!-- åˆ†é¡µ -->
        <div class="pagination" id="pagination" style="display: none;">
            <button onclick="changePage(-1)" id="prev-btn">ä¸Šä¸€é¡µ</button>
            <span class="page-info" id="page-info">ç¬¬ 1 é¡µï¼Œå…± 1 é¡µ</span>
            <button onclick="changePage(1)" id="next-btn">ä¸‹ä¸€é¡µ</button>
        </div>
    </div>
    
    <script>
        const brandId = {{ brand_id }};
        let currentPage = 1;
        let currentPlatform = '';
        let totalPages = 1;
        const pageSize = 20;
        
        // æ ¼å¼åŒ–æ—¶é—´
        function formatTime(timestamp) {
            if (!timestamp) return 'æœªçŸ¥æ—¶é—´';
            
            // å°è¯•è½¬ä¸ºæ•°å­—
            let ts = Number(timestamp);
            let date;
            
            // å¦‚æœè½¬æ¢æˆåŠŸä¸”æ˜¯åˆç†çš„æ•°å­—
            if (!isNaN(ts)) {
                // å¦‚æœæ˜¯æ¯«ç§’çº§ (13ä½)
                if (ts > 1000000000000) {
                     date = new Date(ts);
                } else {
                     // ç§’çº§ (10ä½)
                     date = new Date(ts * 1000);
                }
            } else {
                // å°è¯•ç›´æ¥è§£æå­—ç¬¦ä¸²
                date = new Date(timestamp);
            }
            
            // æ£€æŸ¥æ—¥æœŸæ˜¯å¦æœ‰æ•ˆ
            if (date.toString() === 'Invalid Date') {
                return String(timestamp); // è§£æå¤±è´¥ï¼Œè¿”å›åŸå€¼
            }
            
            // æ£€æŸ¥æ˜¯å¦æ˜¯ 1970 å¹´ (æ— æ•ˆçš„åˆå§‹æ—¶é—´æˆ³)
            if (date.getFullYear() <= 1970) {
                return 'æ—¶é—´æ— æ•ˆ';
            }
            
            return date.toLocaleString('zh-CN');
        }

        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        window.onload = function() {
            loadStats();
            loadData();
        };
        
        // åŠ è½½ç»Ÿè®¡æ•°æ®
        async function loadStats() {
            try {
                const response = await fetch(`/api/v1/brands/${brandId}/data/stats`);
                const result = await response.json();
                
                if (result.code === 200) {
                    const data = result.data;
                    document.getElementById('brand-name').textContent = data.brand_name;
                    document.getElementById('total-count').textContent = data.total || 0;
                    
                    // æ˜¾ç¤ºå¹³å°ç»Ÿè®¡
                    if (data.platforms && data.platforms.length > 0) {
                        const platformHtml = data.platforms.map(p => 
                            `${p._id}: ${p.count}æ¡`
                        ).join(' | ');
                        document.getElementById('platform-stats').querySelector('.value').textContent = platformHtml;
                    } else {
                        document.getElementById('platform-stats').querySelector('.value').textContent = 'æš‚æ— æ•°æ®';
                    }
                }
            } catch (error) {
                console.error('åŠ è½½ç»Ÿè®¡å¤±è´¥:', error);
            }
        }
        
        // åŠ è½½æ•°æ®åˆ—è¡¨
        async function loadData(page = 1) {
            currentPage = page;
            const platform = document.getElementById('platform-filter').value;
            currentPlatform = platform;
            
            const dataList = document.getElementById('data-list');
            dataList.innerHTML = '<div class="loading">åŠ è½½ä¸­...</div>';
            
            const errorDiv = document.getElementById('error');
            errorDiv.style.display = 'none';
            
            try {
                let url = `/api/v1/brands/${brandId}/data?page=${page}&page_size=${pageSize}`;
                if (platform) {
                    url += `&platform=${platform}`;
                }
                
                const response = await fetch(url);
                const result = await response.json();
                
                if (result.code === 200) {
                    const data = result.data;
                    totalPages = Math.ceil(data.total / pageSize);
                    
                    if (data.items && data.items.length > 0) {
                        displayData(data.items);
                        updatePagination(data.total, page);
                    } else {
                        dataList.innerHTML = '<div class="empty"><div class="empty-icon">ğŸ“­</div><div>æš‚æ— æ•°æ®</div></div>';
                        document.getElementById('pagination').style.display = 'none';
                    }
                } else {
                    throw new Error(result.message || 'åŠ è½½æ•°æ®å¤±è´¥');
                }
            } catch (error) {
                errorDiv.textContent = 'åŠ è½½æ•°æ®å¤±è´¥: ' + error.message;
                errorDiv.style.display = 'block';
                dataList.innerHTML = '';
            }
        }
        
        // æ˜¾ç¤ºæ•°æ®
        function displayData(items) {
            const dataList = document.getElementById('data-list');
            dataList.innerHTML = '';
            
            // é‡ç½®å…¨é€‰çŠ¶æ€
            document.getElementById('select-all').checked = false;
            updateSelection();
            
            items.forEach(item => {
                const itemDiv = document.createElement('div');
                itemDiv.className = 'data-item';
                
                const platform = item.platform || 'unknown';
                const platformNames = {
                    'xhs': 'å°çº¢ä¹¦',
                    'douyin': 'æŠ–éŸ³',
                    'weibo': 'å¾®åš',
                    'zhihu': 'çŸ¥ä¹',
                    'bilibili': 'Bç«™',
                    'kuaishou': 'å¿«æ‰‹'
                };
                
                // å¤„ç†åª’ä½“æ˜¾ç¤º
                let mediaHtml = '';
                let hasMedia = false;
                
                // 1. å°è¯•ä» raw_data ä¸­æ¨æ–­è§†é¢‘è·¯å¾„ (å‡è®¾æ ‡å‡† MediaCrawler ç›®å½•ç»“æ„)
                // è·¯å¾„è§„åˆ™: /media/douyin/{date}/{content_id}/video.mp4
                // æˆ‘ä»¬éœ€è¦ä» crawled_at è·å–æ—¥æœŸ
                if (platform === 'douyin' && item.crawled_at && item.content_id) {
                    try {
                        // æå–æ—¥æœŸ YYYYMMDD
                        // item.crawled_at æ ¼å¼é€šå¸¸æ˜¯ "2024-01-14T15:00:00"
                        const dateObj = new Date(item.crawled_at);
                        const year = dateObj.getFullYear();
                        const month = String(dateObj.getMonth() + 1).padStart(2, '0');
                        const day = String(dateObj.getDate()).padStart(2, '0');
                        // MediaCrawler é»˜è®¤æŒ‰æ—¥æœŸæ–‡ä»¶å¤¹å­˜å‚¨å—ï¼Ÿé€šå¸¸æ˜¯çš„ï¼Œä½†ä¸ç¡®å®šå…·ä½“æ ¼å¼
                        // å¾ˆå¤šæ—¶å€™æ˜¯æŒ‰å…³é”®è¯æˆ–å¹³å°åˆ†ã€‚
                        // ç”±äºè·¯å¾„ä¸ç¡®å®šï¼Œè¿™é‡Œæˆ‘ä»¬å…ˆä¸å¼ºè¡ŒçŒœæµ‹ï¼Œé™¤éæˆ‘ä»¬èƒ½ä» raw_data ä¸­æ‰¾åˆ° file_path
                        
                        // å¦‚æœæœ‰ images åˆ—è¡¨
                        if (item.media && item.media.images && item.media.images.length > 0) {
                             // å¦‚æœæ˜¯æœ¬åœ°è·¯å¾„ï¼Œåº”è¯¥ä»¥ data/ å¼€å¤´? æˆ–è€…æ˜¯ url
                             // æš‚ä¸å¤„ç†å›¾ç‰‡ï¼Œä¼˜å…ˆè§†é¢‘
                        }
                    } catch(e) {}
                }

                // è·å–åŸæ–‡é“¾æ¥
                let originalUrl = '#';
                if (item.raw_data && item.raw_data.url) {
                    originalUrl = item.raw_data.url;
                } else if (item.url) {
                    originalUrl = item.url;
                } else if (item.raw_data && item.raw_data.share_url) {
                     originalUrl = item.raw_data.share_url;
                } else if (platform === 'douyin' && item.content_id) {
                     // å°è¯•æ„é€ é“¾æ¥
                     originalUrl = `https://www.douyin.com/video/${item.content_id}`;
                } else if (platform === 'xhs' && item.content_id) {
                     originalUrl = `https://www.xiaohongshu.com/explore/${item.content_id}`;
                }

                // å‘å¸ƒæ—¶é—´
                const publishTime = formatTime(item.publish_time || (item.raw_data && item.raw_data.create_time) || item.crawled_at);

                // æ„å»ºåª’ä½“é¢„è§ˆåŒº
                let previewHtml = '';
                // å¦‚æœæœ‰æœ¬åœ°è§†é¢‘è·¯å¾„è®°å½• (éœ€è¦ CrawlerService é…åˆè®°å½•)
                if (item.video_path) {
                     // å‡è®¾ /media å·²ç»æŒ‚è½½åˆ° crawled_data
                     // video_path åº”è¯¥æ˜¯ç›¸å¯¹è·¯å¾„ï¼Œå¦‚ douyin/20240114/xxx.mp4
                     previewHtml = `
                        <div class="data-preview">
                            <video controls src="/media/${item.video_path}"></video>
                        </div>
                     `;
                } else if (item.image_path) {
                     previewHtml = `
                        <div class="data-preview">
                            <img src="/media/${item.image_path}" alt="å°é¢">
                        </div>
                     `;
                }

                itemDiv.innerHTML = `
                    <div class="data-item-header">
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <input type="checkbox" class="item-checkbox" value="${item._id}" onchange="updateSelection()" style="width: 18px; height: 18px; cursor: pointer;">
                            <span class="platform-badge platform-${platform}">${platformNames[platform] || platform}</span>
                            <span style="margin-left: 10px; color: #666; font-size: 12px;">
                                å‘å¸ƒäº: ${publishTime}
                            </span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 10px;">
                            ${item.task_id ? `<span style="color: #666; font-size: 12px;">ä»»åŠ¡ID: ${item.task_id}</span>` : ''}
                            <button onclick="deleteItem('${item._id}')" style="padding: 4px 10px; font-size: 12px; background: #f44336; min-width: auto;">åˆ é™¤</button>
                        </div>
                    </div>
                    <div class="data-content">
                        <div class="data-main-info">
                             ${previewHtml}
                             <div class="data-details">
                                 <h4 style="margin-bottom: 5px;">
                                     ${originalUrl !== '#' ? `<a href="${originalUrl}" target="_blank" style="color: #333; text-decoration: none; hover:text-decoration: underline;">${item.title || 'æ— æ ‡é¢˜'}</a>` : (item.title || 'æ— æ ‡é¢˜')}
                                 </h4>
                                 <p style="font-size: 14px; color: #555; margin-bottom: 5px; white-space: pre-wrap;">${(item.content || '').substring(0, 300)}${(item.content && item.content.length > 300) ? '...' : ''}</p>
                                 
                                 <div style="margin-top: 10px; display: flex; gap: 10px;">
                                     ${originalUrl !== '#' ? `<a href="${originalUrl}" target="_blank" class="link-btn">ğŸ”— æŸ¥çœ‹åŸæ–‡</a>` : ''}
                                 </div>
                                 
                                 <div style="margin-top: 10px; font-size: 12px; color: #888;">
                                     ä½œè€…: ${item.author ? (item.author.name || 'æœªçŸ¥') : 'æœªçŸ¥'} | 
                                     äº’åŠ¨: ğŸ‘ ${item.engagement ? (item.engagement.likes || 0) : 0} 
                                     ğŸ’¬ ${item.engagement ? (item.engagement.comments || 0) : 0}
                                     ğŸ‘ï¸ ${item.engagement ? (item.engagement.views || 0) : 0} |
                                     é‡‡é›†æ—¶é—´: ${new Date(item.crawled_at).toLocaleString('zh-CN')}
                                 </div>
                             </div>
                        </div>
                        <button onclick="toggleRawData(this)" class="expand-btn">æ˜¾ç¤ºåŸå§‹æ•°æ®</button>
                        <pre style="display: none;">${JSON.stringify(item, null, 2)}</pre>
                    </div>
                `;
                
                dataList.appendChild(itemDiv);
            });
        }
        
        function toggleRawData(btn) {
            const pre = btn.nextElementSibling;
            if (pre.style.display === 'none') {
                pre.style.display = 'block';
                btn.textContent = 'éšè—åŸå§‹æ•°æ®';
            } else {
                pre.style.display = 'none';
                btn.textContent = 'æ˜¾ç¤ºåŸå§‹æ•°æ®';
            }
        }
        
        // å…¨é€‰/åé€‰
        function toggleSelectAll() {
            const isChecked = document.getElementById('select-all').checked;
            document.querySelectorAll('.item-checkbox').forEach(cb => cb.checked = isChecked);
            updateSelection();
        }

        // æ›´æ–°é€‰æ‹©çŠ¶æ€
        function updateSelection() {
            const count = document.querySelectorAll('.item-checkbox:checked').length;
            const btn = document.getElementById('batch-delete-btn');
            const countSpan = document.getElementById('selected-count');
            
            if (count > 0) {
                btn.style.display = 'inline-block';
                btn.textContent = `æ‰¹é‡åˆ é™¤ (${count})`;
                countSpan.textContent = `å·²é€‰ ${count} é¡¹`;
            } else {
                btn.style.display = 'none';
                countSpan.textContent = '';
            }
        }

        // åˆ é™¤å•ä¸ªé¡¹ç›®
        async function deleteItem(id) {
            if(!confirm('ç¡®å®šè¦åˆ é™¤è¿™æ¡æ•°æ®å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ï¼')) return;
            await performDelete([id]);
        }

        // æ‰¹é‡åˆ é™¤
        async function deleteSelected() {
            const ids = Array.from(document.querySelectorAll('.item-checkbox:checked')).map(cb => cb.value);
            if(ids.length === 0) return;
            
            if(!confirm(`ç¡®å®šè¦åˆ é™¤é€‰ä¸­çš„ ${ids.length} æ¡æ•°æ®å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ï¼`)) return;
            await performDelete(ids);
        }

        // æ‰§è¡Œåˆ é™¤æ“ä½œ
        async function performDelete(ids) {
            try {
                const response = await fetch(`/api/v1/brands/${brandId}/data/delete-batch`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({ids: ids})
                });
                const result = await response.json();
                
                if(result.code === 200) {
                    // æ˜¾ç¤ºç®€å•çš„æˆåŠŸæç¤ºï¼Œä¸ä½¿ç”¨alertæ‰“æ–­æµç¨‹
                    const deletedCount = result.data.deleted_count;
                    const message = document.createElement('div');
                    message.style.cssText = `
                        position: fixed;
                        top: 20px;
                        right: 20px;
                        background: #4caf50;
                        color: white;
                        padding: 15px 25px;
                        border-radius: 8px;
                        box-shadow: 0 4px 12px rgba(0,0,0,0.2);
                        z-index: 10000;
                        animation: slideIn 0.3s;
                    `;
                    message.textContent = `æˆåŠŸåˆ é™¤ ${deletedCount} æ¡æ•°æ®`;
                    document.body.appendChild(message);
                    
                    setTimeout(() => {
                        message.remove();
                    }, 3000);

                    // é‡æ–°åŠ è½½æ•°æ®
                    loadData(currentPage);
                    loadStats();
                } else {
                    alert('åˆ é™¤å¤±è´¥: ' + (result.message || 'æœªçŸ¥é”™è¯¯'));
                }
            } catch(e) {
                console.error('åˆ é™¤è¯·æ±‚å¼‚å¸¸:', e);
                alert('åˆ é™¤å¤±è´¥: ' + e.message);
            }
        }
        
        // æ›´æ–°åˆ†é¡µ
        function updatePagination(total, page) {
            const pagination = document.getElementById('pagination');
            pagination.style.display = 'flex';
            
            document.getElementById('page-info').textContent = 
                `ç¬¬ ${page} é¡µï¼Œå…± ${totalPages} é¡µï¼Œæ€»è®¡ ${total} æ¡`;
            
            document.getElementById('prev-btn').disabled = page <= 1;
            document.getElementById('next-btn').disabled = page >= totalPages;
        }
        
        // åˆ‡æ¢é¡µé¢
        function changePage(delta) {
            const newPage = currentPage + delta;
            if (newPage >= 1 && newPage <= totalPages) {
                loadData(newPage);
            }
        }
        
        // å¹³å°ç­›é€‰å˜åŒ–
        document.getElementById('platform-filter').addEventListener('change', function() {
            loadData(1);
        });
    </script>
</body>
</html>
